# 权限控制

## User Controller

- 文件名：api/controller/User.php
- 第2105行插入

```php
/**
     * 判断用户是否在白名单
     * @return mixed
     */
    public function isWhitelist()
    {
        $data = $this->param;
        if (empty($data['action'])) {
            return api_error(['code' => '0010', 'msg' => 'Action参数不能为空']);
        }

        if (!preg_match('/^[a-z0-9A-Z\/]+$/', $data['action'])) {
            return api_error(['code' => '0010', 'msg' => 'Action参数不合法']);
        }

        $action = $data['action'];
        $userInfo = get_user_by_token($data);
        $uid = intval($userInfo['uid']);

        $isWhitelist = false;
        $list = $this->logicUserWhitelist->isWhitelist($uid, $action);

        if (!empty($list) || is_array($list)) {
            $isWhitelist = true;
        }

        return $this->apiReturn(
            ['is_whitelist' => $isWhitelist, 'action' => $action]
        );
    }
```
